---
apiVersion: v1
kind: ConfigMap
metadata:
  name: backstage-catalog
  namespace: backstage
data:
  platform-services.yaml: |
    ---
    apiVersion: backstage.io/v1alpha1
    kind: Domain
    metadata:
      name: infrastructure
      title: Infrastructure
      description: Platform infrastructure and core services
    spec:
      owner: platform-team
    ---
    apiVersion: backstage.io/v1alpha1
    kind: Group
    metadata:
      name: platform-team
      title: Platform Team
      description: Team responsible for platform infrastructure
    spec:
      type: team
      profile:
        displayName: Platform Engineering Team
      children: []
    ---
    apiVersion: backstage.io/v1alpha1
    kind: System
    metadata:
      name: platform
      title: K8s Platform Services
      description: Core platform infrastructure services
      links:
        - url: http://localhost:7007
          title: Backstage Portal
        - url: http://localhost:3000
          title: Grafana Dashboards
        - url: http://localhost:9090
          title: Prometheus
    spec:
      owner: platform-team
      domain: infrastructure
    ---
    apiVersion: backstage.io/v1alpha1
    kind: Component
    metadata:
      name: prometheus
      title: Prometheus
      description: Metrics collection and alerting
      annotations:
        backstage.io/kubernetes-id: prometheus
        backstage.io/kubernetes-namespace: monitoring
        backstage.io/kubernetes-label-selector: 'app.kubernetes.io/name=prometheus'
      links:
        - url: http://localhost:9090
          title: Prometheus UI
          icon: monitoring
        - url: http://localhost:9090/targets
          title: Targets
        - url: http://localhost:9090/alerts
          title: Alerts
    spec:
      type: service
      lifecycle: production
      owner: platform-team
      system: platform
      providesApis: []
    ---
    apiVersion: backstage.io/v1alpha1
    kind: Component
    metadata:
      name: grafana
      title: Grafana
      description: Metrics visualization and dashboards
      annotations:
        backstage.io/kubernetes-id: grafana
        backstage.io/kubernetes-namespace: monitoring
        backstage.io/kubernetes-label-selector: 'app.kubernetes.io/name=grafana'
      links:
        - url: http://localhost:3000
          title: Grafana UI
          icon: dashboard
        - url: http://localhost:3000/dashboards
          title: Dashboards
        - url: http://localhost:3000/datasources
          title: Data Sources
    spec:
      type: service
      lifecycle: production
      owner: platform-team
      system: platform
      dependsOn:
        - component:prometheus
    ---
    apiVersion: backstage.io/v1alpha1
    kind: Component
    metadata:
      name: istio
      title: Istio Service Mesh
      description: Service mesh for traffic management and security
      annotations:
        backstage.io/kubernetes-id: istiod
        backstage.io/kubernetes-namespace: istio-system
        backstage.io/kubernetes-label-selector: 'app=istiod'
      links:
        - url: https://istio.io/latest/docs/
          title: Documentation
    spec:
      type: service
      lifecycle: production
      owner: platform-team
      system: platform
    ---
    apiVersion: backstage.io/v1alpha1
    kind: Component
    metadata:
      name: ingress-nginx
      title: Ingress NGINX
      description: Kubernetes ingress controller
      annotations:
        backstage.io/kubernetes-id: ingress-nginx
        backstage.io/kubernetes-namespace: ingress-nginx
        backstage.io/kubernetes-label-selector: 'app.kubernetes.io/name=ingress-nginx'
    spec:
      type: service
      lifecycle: production
      owner: platform-team
      system: platform
    ---
    apiVersion: backstage.io/v1alpha1
    kind: Component
    metadata:
      name: cert-manager
      title: cert-manager
      description: X.509 certificate management for Kubernetes
      annotations:
        backstage.io/kubernetes-id: cert-manager
        backstage.io/kubernetes-namespace: cert-manager
        backstage.io/kubernetes-label-selector: 'app.kubernetes.io/name=cert-manager'
    spec:
      type: service
      lifecycle: production
      owner: platform-team
      system: platform
    ---
    apiVersion: backstage.io/v1alpha1
    kind: Component
    metadata:
      name: fluent-bit
      title: Fluent Bit
      description: Log collection and forwarding
      annotations:
        backstage.io/kubernetes-id: fluent-bit
        backstage.io/kubernetes-namespace: logging
        backstage.io/kubernetes-label-selector: 'app.kubernetes.io/name=fluent-bit'
    spec:
      type: service
      lifecycle: production
      owner: platform-team
      system: platform
