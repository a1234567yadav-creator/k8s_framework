# Minimal ELK stack for 4-core constraint
elasticsearch:
  replicas: 1
  # Remove minimumMasterNodes for single-node setup
  esJavaOpts: "-Xmx256m -Xms256m"
  resources:
    requests:
      cpu: 200m
      memory: 512Mi
    limits:
      cpu: 500m
      memory: 1Gi
  volumeClaimTemplate:
    resources:
      requests:
        storage: 2Gi
  extraEnvs:
    - name: xpack.security.enabled
      value: "false"
    - name: discovery.type
      value: "single-node"
  esConfig:
    elasticsearch.yml: |
      discovery.type: single-node
      xpack.security.enabled: false

kibana:
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 300m
      memory: 512Mi
  elasticsearchHosts: "http://elasticsearch-master:9200"

fluent-bit:
  resources:
    requests:
      cpu: 50m
      memory: 64Mi
    limits:
      cpu: 100m
      memory: 128Mi
  config:
    outputs: |
      [OUTPUT]
          Name  es
          Match *
          Host  elasticsearch-master.logging.svc.cluster.local
          Port  9200
          Index fluent-bit
          Logstash_Format On
          Retry_Limit False
